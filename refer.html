<script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>
<script>
function getQuery(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=c.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}
if (window.location.search === "?" || window.location.search === null || window.location.search === "") {
	window.location.href = "404.html"
}
console.log(1)
var redirect = getQuery("continue");
var username = getQuery("username");
var key = getQuery("key")
var email = getQuery("email")
var token = getQuery("token")
console.log(2)
var fb = new Firebase("https://ccim2.firebaseio.com/keys/");
fb.on("value", function(snapshot) {
	console.log(3)
	if (snapshot.child(key).val() === username && username !== "placeholder" && key !== "invalidPlaceholder") {
		console.log(true)
		localStorage.setItem("username", username);
		localStorage.setItem("key", key);
		localStorage.setItem("email", email);
		sessionStorage.setItem("auth", "true")
		localStorage.setItem("token", token)
		window.location.href = decodeURIComponent(redirect);
	}
}, function (errorObject) {
  console.log("The read failed: " + errorObject.code);
});

</script>